# 旅游地图项目描述

## 1. 技术栈

| 技术/工具 | 用途 | 说明 |
|---------|------|------|
| Vue.js | 前端框架 | 用于构建响应式用户界面的渐进式JavaScript框架 |
| OpenLayers (ol) | 地图库 | 提供高性能、交互式地图功能的开源JavaScript库 |
| LocalStorage | 数据存储 | 用于客户端数据持久化存储，无需后端支持 |

## 2. 主要功能

### 2.1 地图管理
- 地图初始化与配置
- 图层管理（瓦片图层、矢量图层）
- 坐标系统转换
- POI标记显示与交互

### 2.2 旅游点(POI)管理
- 旅游点的创建、编辑、删除
- 旅游点定位与地图标记
- 旅游点数据的本地存储与加载

### 2.3 旅行计划管理
- 旅行计划的创建、更新、删除
- 旅行计划的选择与切换
- 旅行相关数据的关联管理

### 2.4 预算管理
- 消费记录的添加与查看
- 消费与旅游点的关联
- 预算数据的本地存储与统计

## 3. 核心功能

### 3.1 地图渲染与交互
- 使用OpenLayers初始化高性能地图实例
- 支持多种地图图层类型（瓦片、矢量）
- 实现自定义样式的POI标记（可配置颜色、大小）
- 提供坐标转换工具（经纬度与地图投影坐标互转）

### 3.2 数据管理系统
- 基于LocalStorage的客户端数据持久化
- 实现POI、旅行计划、预算数据的CRUD操作
- 数据之间的关联与级联操作（如删除旅行时自动清理相关数据）

### 3.3 用户界面与交互
- 响应式布局设计，适配不同设备
- 直观的旅行计划管理界面
- 地图与数据面板的联动交互
- 清晰的预算管理与消费记录界面

## 4. 目录结构

```
├── dist/                     # 构建输出目录
│   ├── bankground/           # 构建后的瓦片地图数据
│   ├── css/                  # 构建后的CSS文件
│   ├── js/                   # 构建后的JavaScript文件
│   └── index.html            # 构建后的入口HTML文件
├── public/                   # 静态资源目录
│   └── bankground/           # 瓦片地图数据（Z/X/Y格式）
├── src/                      # 源代码目录
│   ├── assets/               # 资源文件
│   │   ├── area.json         # 区域数据（GeoJSON格式）
│   │   └── 旅游点示例.json    # 旅游点示例数据
│   ├── components/           # Vue组件
│   │   ├── AreaTable.vue     # 区域数据表格组件
│   │   ├── Budget.vue        # 预算管理主组件
│   │   ├── BudgetModal.vue   # 预算添加/编辑模态框
│   │   ├── BudgetSum.vue     # 预算统计组件
│   │   ├── BudgetTable.vue   # 预算表格组件
│   │   ├── Map.vue           # 地图主组件
│   │   ├── POIInfo.vue       # 旅游点信息面板组件
│   │   ├── POIList.vue       # 旅游点列表组件
│   │   ├── POIModal.vue      # 旅游点添加/编辑模态框
│   │   ├── TripCard.vue      # 旅行卡片组件
│   │   ├── TripManager.vue   # 旅行管理组件
│   │   └── TripModal.vue     # 旅行添加/编辑模态框
│   ├── utils/                # 工具函数
│   │   ├── Budget.js         # 预算数据操作工具
│   │   ├── MapUtils.js       # 地图工具函数
│   │   ├── Poi.js            # 旅游点数据操作工具
│   │   └── Trip.js           # 旅行数据操作工具
│   ├── App.vue               # 主应用组件
│   ├── main.js               # 应用入口文件
│   └── style.css             # 全局样式文件
├── README.md                 # 项目说明文档
├── babel.config.js           # Babel配置文件
├── jsconfig.json             # JavaScript配置文件
├── package-lock.json         # npm依赖锁定文件
└── package.json              # npm项目配置文件
```

## 5. 组件作用

- ### 5.1 地图相关组件

  #### Map.vue

  - **核心作用**：地图主组件，负责地图渲染和交互
  - **主要功能**：
    - 地图初始化与配置
    - 旅游点标记的显示与管理
    - 地图点击事件处理
    - 区域查看功能
    - WMS图层管理
  - **技术特点**：
    - 使用OpenLayers实现地图功能
    - 支持瓦片地图和矢量图层
    - 坐标系统转换
    - 与其他组件的事件通信

  #### AreaTable.vue

  - **核心作用**：区域数据表格组件
  - **主要功能**：
    - 显示区域数据列表
    - 支持按名称搜索
    - 支持按类型（省份/城市/景区）筛选
    - 区域地图定位功能
    - 表格展开/折叠控制
  - **技术特点**：
    - 从JSON文件加载区域数据
    - 三级联动数据选择
    - 与地图组件联动

  ### 5.2 旅游点(POI)相关组件

  #### POIList.vue

  - **核心作用**：旅游点列表侧边栏组件
  - **主要功能**：
    - 显示旅游点列表
    - 支持按旅行计划筛选
    - 旅游点查看与编辑
    - 与地图组件联动
  - **技术特点**：
    - 响应式侧边栏设计
    - 支持多种筛选条件
    - 实时更新旅游点状态

  #### POIInfo.vue

  - **核心作用**：旅游点信息面板组件
  - **主要功能**：
    - 显示旅游点详细信息
    - 提供编辑和删除功能
    - 支持添加消费记录
    - 信息面板的显示与隐藏
  - **技术特点**：
    - 固定定位的信息面板
    - 与地图标记联动
    - 事件驱动的交互

  #### POIModal.vue

  - **核心作用**：旅游点添加/编辑模态框组件
  - **主要功能**：
    - 旅游点信息的表单输入
    - 旅行计划关联选择
    - 日期时间选择
    - 表单验证与提交
  - **技术特点**：
    - 模态框样式设计
    - 支持添加/编辑两种模式
    - 数据格式转换（日期转时间戳）

  ### 5.3 旅行计划相关组件

  #### TripManager.vue

  - **核心作用**：旅行计划管理组件
  - **主要功能**：
    - 旅行计划的列表展示
    - 旅行计划的添加、编辑、删除
    - 旅行计划的选择与切换
    - 与旅游点的关联管理
  - **技术特点**：
    - 卡片式布局设计
    - 旅行数据的本地存储
    - 与地图组件的联动

  #### TripModal.vue

  - **核心作用**：旅行添加/编辑模态框组件
  - **主要功能**：
    - 旅行目的地的三级选择（省份→城市→景区）
    - 旅行时间设置与天数计算
    - 旅行预算设置
    - 表单验证与提交
  - **技术特点**：
    - 基于GB编码的区域关联
    - 日期自动计算功能
    - 动态数据加载

  #### TripCard.vue

  - **核心作用**：旅行计划卡片组件
  - **主要功能**：
    - 旅行计划信息的卡片式展示
    - 旅行选择与删除功能
    - 旅行状态的视觉反馈
  - **技术特点**：
    - 响应式卡片设计
    - 悬停效果与交互反馈
    - 数据驱动的UI更新

  ### 1.4 预算管理相关组件

  #### Budget.vue

  - **核心作用**：预算管理主组件
  - **主要功能**：
    - 预算数据的集中管理
    - 消费记录的添加与查看
    - 预算统计与分析
    - 与旅游点的关联管理
  - **技术特点**：
    - 模块化预算功能
    - 数据持久化存储
    - 与其他组件的事件通信

  #### BudgetModal.vue

  - **核心作用**：预算添加/编辑模态框组件
  - **主要功能**：
    - 消费记录的表单输入
    - 消费分类选择
    - 消费金额设置
    - 表单验证与提交
  - **技术特点**：
    - 模态框样式设计
    - 表单验证机制
    - 数据格式处理

  #### BudgetTable.vue

  - **核心作用**：预算表格组件
  - **主要功能**：
    - 消费记录的表格展示
    - 支持按旅游点筛选
    - 消费记录的编辑与删除
  - **技术特点**：
    - 响应式表格设计
    - 数据分页与排序
    - 实时数据更新

  #### BudgetSum.vue

  - **核心作用**：预算统计组件
  - **主要功能**：
    - 消费总额统计
    - 按分类统计消费
    - 预算使用情况展示
  - **技术特点**：
    - 数据聚合计算
    - 可视化统计展示
    - 实时更新统计结果

## 6. 核心工具函数

### 6.1 MapUtils.js

- **核心作用**：地图相关工具函数的集合
- **主要方法**：
  - `createStyle(radius, fillColor, strokeColor, strokeWidth)`：创建自定义地图标记样式
  - `getBaseLayer(map)`：获取地图底图图层
  - `setLayerVisibility(layer, visible)`：设置图层可见性
  - `hideBaseLayers(map, areaLayer)`：隐藏底图和区域图层
  - `createWmsParams(layerName)`：创建WMS请求参数
  - `updateWms(map, layerName, wmsLayer)`：更新WMS图层
  - `resetView(map)`：重置地图视图到初始状态

### 6.2 Poi.js
- **核心作用**：旅游点数据操作工具函数
- **主要方法**：
  - `getLsPois()`：从本地存储获取所有旅游点
  - `addPoi(poi)`：添加新旅游点
  - `updPoi(poi)`：更新旅游点信息
  - `delPoi(id)`：删除旅游点
  - `createNewPoi(lon, lat, travel)`：创建新旅游点对象
  - `mapPoiUtils`：地图相关的旅游点操作函数
    - `selectPoiOnMap(map, toLonLat, createPoi)`：在地图上选择位置创建旅游点
    - `viewPoiOnMap(map, poi, fromLonLat, updateWms, hideLayers)`：在地图上查看旅游点
    - `addPoiMarkers(source, pois, fromLonLat, Point, Feature)`：添加旅游点标记
    - `deletePoiMarker(source, poiId)`：删除旅游点标记
    - `filterPoisByTravel(pois, travel)`：按旅行计划过滤旅游点

### 6.3 Trip.js
- **核心作用**：旅行计划数据操作工具函数
- **主要方法**：
  - `getAllTrips()`：获取所有旅行计划
  - `addTrip(trip)`：添加新旅行计划
  - `updTrip(trip)`：更新旅行计划
  - `delTrip(id)`：删除旅行计划
  - `getLsTrips()`：从本地存储获取旅行计划
  - `saveLsTrips(trips)`：保存旅行计划到本地存储

### 6.4 Budget.js
- **核心作用**：预算数据操作工具函数
- **主要方法**：
  - `getLsBudgetItems()`：从本地存储获取预算项目
  - `saveLsBudgetItems(items)`：保存预算项目到本地存储
  - `addBudgetItem(item)`：添加预算项目
  - `updBudgetItem(item)`：更新预算项目
  - `delBudgetItem(id)`：删除预算项目
